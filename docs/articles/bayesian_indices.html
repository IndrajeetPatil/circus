<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Systematic Simulation of Bayesian Models • circus</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Systematic Simulation of Bayesian Models">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">circus</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bayesian_indices.html">Systematic Simulation of Bayesian Models</a>
    </li>
    <li>
      <a href="../articles/bootstrapped.html">Bootsrapped data</a>
    </li>
    <li>
      <a href="../articles/classify_distribution.html">Classify Distributions using Machine Learning</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Systematic Simulation of Bayesian Models</h1>
            
      
      
      <div class="hidden name"><code>bayesian_indices.Rmd</code></div>

    </div>

    
    
<p>This code was used by the articles presented in <a href="https://easystats.github.io/bayestestR/">bayestestR</a> to simulate statistical models.</p>
<div id="functions" class="section level1">
<h1 class="hasAnchor">
<a href="#functions" class="anchor"></a>Functions</h1>
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(logspline)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(bayestestR)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(parameters)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(see)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(rstanarm)</a></code></pre></div>
</div>
<div id="data-generation" class="section level2">
<h2 class="hasAnchor">
<a href="#data-generation" class="anchor"></a>Data generation</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">generate_data &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">true_effect=</span><span class="dv">0</span>, <span class="dt">outcome_type=</span><span class="st">"linear"</span>, <span class="dt">sample_size=</span><span class="dv">50</span>, <span class="dt">error=</span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="co"># Generate data</span></a>
<a class="sourceLine" id="cb2-3" title="3">  data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(sample_size, <span class="dv">0</span>, <span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="cf">if</span>(outcome_type <span class="op">==</span><span class="st"> "linear"</span>){</a>
<a class="sourceLine" id="cb2-5" title="5">     <span class="cf">if</span>(true_effect <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb2-6" title="6">      data<span class="op">$</span>y &lt;-<span class="st"> </span>data<span class="op">$</span>x</a>
<a class="sourceLine" id="cb2-7" title="7">    } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb2-8" title="8">      data<span class="op">$</span>y &lt;-<span class="st"> </span>parameters<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parameters/topics/standardize">standardize</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(data<span class="op">$</span>x<span class="op">*</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb2-9" title="9">    }</a>
<a class="sourceLine" id="cb2-10" title="10">  } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="cf">if</span>(true_effect <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb2-12" title="12">      data<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(data<span class="op">$</span>x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-13" title="13">    } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb2-14" title="14">      data<span class="op">$</span>y &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/ifelse">ifelse</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Trig">cos</a></span>(data<span class="op">$</span>x<span class="op">*</span><span class="dv">5</span>) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-15" title="15">    }</a>
<a class="sourceLine" id="cb2-16" title="16">  }</a>
<a class="sourceLine" id="cb2-17" title="17">  <span class="co"># Add error</span></a>
<a class="sourceLine" id="cb2-18" title="18">  data<span class="op">$</span>x &lt;-<span class="st"> </span>parameters<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parameters/topics/standardize">standardize</a></span>(data<span class="op">$</span>x <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(sample_size, <span class="dv">0</span>, error))</a>
<a class="sourceLine" id="cb2-19" title="19"></a>
<a class="sourceLine" id="cb2-20" title="20">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(data)</a>
<a class="sourceLine" id="cb2-21" title="21"></a>
<a class="sourceLine" id="cb2-22" title="22">}</a></code></pre></div>
</div>
<div id="model-fitting" class="section level2">
<h2 class="hasAnchor">
<a href="#model-fitting" class="anchor"></a>Model fitting</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">compute_models &lt;-<span class="st"> </span><span class="cf">function</span>(data, <span class="dt">outcome_type=</span><span class="st">"linear"</span>, <span class="dt">chains=</span><span class="dv">4</span>, <span class="dt">iter=</span><span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="cf">if</span>(outcome_type <span class="op">==</span><span class="st"> "linear"</span>){</a>
<a class="sourceLine" id="cb3-4" title="4">      model_frequentist &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/lm">lm</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data)</a>
<a class="sourceLine" id="cb3-5" title="5">      temp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/capture.output">capture.output</a></span>(</a>
<a class="sourceLine" id="cb3-6" title="6">        model_bayesian &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data, <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">chains =</span> chains, <span class="dt">iter =</span> iter, <span class="dt">warmup =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(warmup <span class="op">*</span><span class="st"> </span>iter)))</a>
<a class="sourceLine" id="cb3-7" title="7">      </a>
<a class="sourceLine" id="cb3-8" title="8">    } <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb3-9" title="9">      model_frequentist &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/glm">glm</a></span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data, <span class="dt">family =</span> <span class="st">"binomial"</span>)</a>
<a class="sourceLine" id="cb3-10" title="10">      temp &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/capture.output">capture.output</a></span>(</a>
<a class="sourceLine" id="cb3-11" title="11">        model_bayesian &lt;-<span class="st"> </span><span class="kw">stan_glm</span>(y <span class="op">~</span><span class="st"> </span>x, <span class="dt">data =</span> data, <span class="dt">family =</span> <span class="st">"binomial"</span>, <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">chains =</span> chains, <span class="dt">iter =</span> iter, <span class="dt">warmup =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(warmup <span class="op">*</span><span class="st"> </span>iter)))</a>
<a class="sourceLine" id="cb3-12" title="12">    }</a>
<a class="sourceLine" id="cb3-13" title="13"></a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(</a>
<a class="sourceLine" id="cb3-15" title="15">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb3-16" title="16">      <span class="dt">frequentist =</span> model_frequentist, </a>
<a class="sourceLine" id="cb3-17" title="17">      <span class="dt">bayesian =</span> model_bayesian</a>
<a class="sourceLine" id="cb3-18" title="18">      )</a>
<a class="sourceLine" id="cb3-19" title="19">    )</a>
<a class="sourceLine" id="cb3-20" title="20">}</a></code></pre></div>
</div>
<div id="features-extraction" class="section level2">
<h2 class="hasAnchor">
<a href="#features-extraction" class="anchor"></a>Features extraction</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">compute_indices &lt;-<span class="st"> </span><span class="cf">function</span>(models){</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3">  params &lt;-<span class="st"> </span>parameters<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parameters/topics/model_parameters">model_parameters</a></span>(models<span class="op">$</span>frequentist)[<span class="dv">2</span>, ] <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(beta, SE, <span class="dt">CI_low_95_freq =</span> CI_low, <span class="dt">CI_high_95_freq =</span> CI_high, <span class="dt">p_value =</span> p)</a>
<a class="sourceLine" id="cb4-5" title="5">  </a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">  posterior &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/as.data.frame">as.data.frame</a></span>(models<span class="op">$</span>bayesian)<span class="op">$</span>x</a>
<a class="sourceLine" id="cb4-8" title="8">  </a>
<a class="sourceLine" id="cb4-9" title="9">  algorithm &lt;-<span class="st"> </span>insight<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/insight/topics/find_algorithm">find_algorithm</a></span>(models<span class="op">$</span>bayesian)</a>
<a class="sourceLine" id="cb4-10" title="10">  params<span class="op">$</span>chains &lt;-<span class="st"> </span>algorithm<span class="op">$</span>chains</a>
<a class="sourceLine" id="cb4-11" title="11">  params<span class="op">$</span>iterations &lt;-<span class="st"> </span>algorithm<span class="op">$</span>iterations</a>
<a class="sourceLine" id="cb4-12" title="12">  params<span class="op">$</span>warmup &lt;-<span class="st"> </span>algorithm<span class="op">$</span>warmup <span class="op">/</span><span class="st"> </span>params<span class="op">$</span>iterations</a>
<a class="sourceLine" id="cb4-13" title="13">  params<span class="op">$</span>samples &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(posterior)</a>
<a class="sourceLine" id="cb4-14" title="14">  </a>
<a class="sourceLine" id="cb4-15" title="15">  prior &lt;-<span class="st"> </span>bayestestR<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/bayestestR/topics/describe_prior">describe_prior</a></span>(models<span class="op">$</span>bayesian)[<span class="dv">2</span>, ]</a>
<a class="sourceLine" id="cb4-16" title="16">  params<span class="op">$</span>Prior_Distribution &lt;-<span class="st"> </span>prior<span class="op">$</span>Prior_Distribution</a>
<a class="sourceLine" id="cb4-17" title="17">  params<span class="op">$</span>Prior_Location &lt;-<span class="st"> </span>prior<span class="op">$</span>Prior_Location</a>
<a class="sourceLine" id="cb4-18" title="18">  params<span class="op">$</span>Prior_Scale &lt;-<span class="st"> </span>prior<span class="op">$</span>Prior_Scale</a>
<a class="sourceLine" id="cb4-19" title="19">  </a>
<a class="sourceLine" id="cb4-20" title="20">  params<span class="op">$</span>Median &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/median">median</a></span>(posterior)</a>
<a class="sourceLine" id="cb4-21" title="21">  params<span class="op">$</span>Mean &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(posterior)</a>
<a class="sourceLine" id="cb4-22" title="22">  map &lt;-<span class="st"> </span><span class="kw">map_estimate</span>(posterior)</a>
<a class="sourceLine" id="cb4-23" title="23">  params<span class="op">$</span>MAP &lt;-<span class="st"> </span>map</a>
<a class="sourceLine" id="cb4-24" title="24">  </a>
<a class="sourceLine" id="cb4-25" title="25">  params<span class="op">$</span>MAP_density &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/attributes">attributes</a></span>(map)<span class="op">$</span>MAP_density</a>
<a class="sourceLine" id="cb4-26" title="26">  params<span class="op">$</span>p_direction &lt;-<span class="st"> </span><span class="kw">p_direction</span>(posterior, <span class="dt">method=</span><span class="st">"direct"</span>)</a>
<a class="sourceLine" id="cb4-27" title="27">  params<span class="op">$</span>p_direction_AUC &lt;-<span class="st"> </span><span class="kw">p_direction</span>(posterior, <span class="dt">method=</span><span class="st">"logspline"</span>)</a>
<a class="sourceLine" id="cb4-28" title="28">  params<span class="op">$</span>p_MAP &lt;-<span class="st"> </span><span class="kw">p_map</span>(posterior)</a>
<a class="sourceLine" id="cb4-29" title="29">  </a>
<a class="sourceLine" id="cb4-30" title="30">  range &lt;-<span class="st"> </span><span class="kw">rope_range</span>(models<span class="op">$</span>bayesian)</a>
<a class="sourceLine" id="cb4-31" title="31">  params<span class="op">$</span>ROPE_range &lt;-<span class="st"> </span>range[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb4-32" title="32">  params<span class="op">$</span>ROPE_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">rope</span>(posterior, <span class="dt">range =</span> range, <span class="dt">ci=</span><span class="fl">0.90</span>)<span class="op">$</span>ROPE_Percentage</a>
<a class="sourceLine" id="cb4-33" title="33">  params<span class="op">$</span>ROPE_<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw">rope</span>(posterior, <span class="dt">range =</span> range, <span class="dt">ci=</span><span class="fl">0.95</span>)<span class="op">$</span>ROPE_Percentage</a>
<a class="sourceLine" id="cb4-34" title="34">  params<span class="op">$</span>ROPE_full &lt;-<span class="st"> </span><span class="kw">rope</span>(posterior, <span class="dt">range =</span> range, <span class="dt">ci=</span><span class="dv">1</span>)<span class="op">$</span>ROPE_Percentage</a>
<a class="sourceLine" id="cb4-35" title="35">  params<span class="op">$</span>p_ROPE &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/conditions">tryCatch</a></span>({</a>
<a class="sourceLine" id="cb4-36" title="36">  <span class="kw">p_rope</span>(posterior, <span class="dt">range =</span> range)</a>
<a class="sourceLine" id="cb4-37" title="37">  }, <span class="dt">error =</span> <span class="cf">function</span>(error_condition) {</a>
<a class="sourceLine" id="cb4-38" title="38">      <span class="ot">NA</span></a>
<a class="sourceLine" id="cb4-39" title="39">  })</a>
<a class="sourceLine" id="cb4-40" title="40">  <span class="co"># Bayesfactor</span></a>
<a class="sourceLine" id="cb4-41" title="41">  <span class="co"># This doens't really work</span></a>
<a class="sourceLine" id="cb4-42" title="42">  <span class="co"># params$BF &lt;- as.numeric(bayesfactor_savagedickey(models$bayesian,</span></a>
<a class="sourceLine" id="cb4-43" title="43">  <span class="co">#                                   verbose=FALSE)$BF)</span></a>
<a class="sourceLine" id="cb4-44" title="44">  </a>
<a class="sourceLine" id="cb4-45" title="45">  params<span class="op">$</span>BF &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(<span class="kw">bayesfactor_savagedickey</span>(posterior,</a>
<a class="sourceLine" id="cb4-46" title="46">                                    <span class="dt">prior =</span> <span class="kw">distribution_normal</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(posterior),</a>
<a class="sourceLine" id="cb4-47" title="47">                                                                <span class="dt">mean=</span>params<span class="op">$</span>Prior_Location,</a>
<a class="sourceLine" id="cb4-48" title="48">                                                                <span class="dt">sd=</span>params<span class="op">$</span>Prior_Scale),</a>
<a class="sourceLine" id="cb4-49" title="49">                                    <span class="dt">hypothesis =</span> <span class="dv">0</span>,</a>
<a class="sourceLine" id="cb4-50" title="50">                                    <span class="dt">verbose=</span><span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb4-51" title="51">  </a>
<a class="sourceLine" id="cb4-52" title="52">  <span class="co"># CI</span></a>
<a class="sourceLine" id="cb4-53" title="53">  ci_<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw">hdi</span>(posterior, <span class="dt">ci=</span><span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb4-54" title="54">  params<span class="op">$</span>CI_low_<span class="dv">95</span>_hdi &lt;-<span class="st"> </span>ci_<span class="dv">95</span><span class="op">$</span>CI_low</a>
<a class="sourceLine" id="cb4-55" title="55">  params<span class="op">$</span>CI_high_<span class="dv">95</span>_hdi &lt;-<span class="st"> </span>ci_<span class="dv">95</span><span class="op">$</span>CI_high</a>
<a class="sourceLine" id="cb4-56" title="56">  </a>
<a class="sourceLine" id="cb4-57" title="57">  ci_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">hdi</span>(posterior, <span class="dt">ci=</span><span class="fl">0.90</span>)</a>
<a class="sourceLine" id="cb4-58" title="58">  params<span class="op">$</span>CI_low_<span class="dv">90</span>_hdi &lt;-<span class="st"> </span>ci_<span class="dv">90</span><span class="op">$</span>CI_low</a>
<a class="sourceLine" id="cb4-59" title="59">  params<span class="op">$</span>CI_high_<span class="dv">90</span>_hdi &lt;-<span class="st"> </span>ci_<span class="dv">90</span><span class="op">$</span>CI_high</a>
<a class="sourceLine" id="cb4-60" title="60">  </a>
<a class="sourceLine" id="cb4-61" title="61">  ci_<span class="dv">95</span> &lt;-<span class="st"> </span><span class="kw">ci</span>(posterior, <span class="dt">ci=</span><span class="fl">0.95</span>)</a>
<a class="sourceLine" id="cb4-62" title="62">  params<span class="op">$</span>CI_low_<span class="dv">95</span>_quantile &lt;-<span class="st"> </span>ci_<span class="dv">95</span><span class="op">$</span>CI_low</a>
<a class="sourceLine" id="cb4-63" title="63">  params<span class="op">$</span>CI_high_<span class="dv">95</span>_quantile &lt;-<span class="st"> </span>ci_<span class="dv">95</span><span class="op">$</span>CI_high</a>
<a class="sourceLine" id="cb4-64" title="64">  </a>
<a class="sourceLine" id="cb4-65" title="65">  ci_<span class="dv">90</span> &lt;-<span class="st"> </span><span class="kw">ci</span>(posterior, <span class="dt">ci=</span><span class="fl">0.90</span>)</a>
<a class="sourceLine" id="cb4-66" title="66">  params<span class="op">$</span>CI_low_<span class="dv">90</span>_quantile &lt;-<span class="st"> </span>ci_<span class="dv">90</span><span class="op">$</span>CI_low</a>
<a class="sourceLine" id="cb4-67" title="67">  params<span class="op">$</span>CI_high_<span class="dv">90</span>_quantile &lt;-<span class="st"> </span>ci_<span class="dv">90</span><span class="op">$</span>CI_high</a>
<a class="sourceLine" id="cb4-68" title="68">    </a>
<a class="sourceLine" id="cb4-69" title="69">  </a>
<a class="sourceLine" id="cb4-70" title="70">  params</a>
<a class="sourceLine" id="cb4-71" title="71">}</a></code></pre></div>
</div>
<div id="wrapper" class="section level2">
<h2 class="hasAnchor">
<a href="#wrapper" class="anchor"></a>Wrapper</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">generate_and_process &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">true_effect=</span><span class="dv">0</span>, <span class="dt">outcome_type=</span><span class="st">"linear"</span>, <span class="dt">sample_size=</span><span class="dv">50</span>, <span class="dt">error=</span><span class="dv">0</span>, <span class="dt">chains=</span><span class="dv">4</span>, <span class="dt">iter=</span><span class="dv">2000</span>, <span class="dt">warmup =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">modulate_priors =</span> <span class="ot">FALSE</span>){</a>
<a class="sourceLine" id="cb5-2" title="2">  </a>
<a class="sourceLine" id="cb5-3" title="3">  data &lt;-<span class="st"> </span><span class="kw">generate_data</span>(<span class="dt">true_effect=</span>true_effect, <span class="dt">outcome_type=</span>outcome_type, <span class="dt">sample_size=</span>sample_size, <span class="dt">error=</span>error)</a>
<a class="sourceLine" id="cb5-4" title="4">  models &lt;-<span class="st"> </span><span class="kw">compute_models</span>(data, <span class="dt">outcome_type=</span>outcome_type, <span class="dt">chains=</span>chains, <span class="dt">iter=</span>iter, <span class="dt">warmup =</span> warmup)</a>
<a class="sourceLine" id="cb5-5" title="5">  params &lt;-<span class="st"> </span><span class="kw">compute_indices</span>(models)</a>
<a class="sourceLine" id="cb5-6" title="6">  params<span class="op">$</span>Prior &lt;-<span class="st"> "Uninformative"</span></a>
<a class="sourceLine" id="cb5-7" title="7">  </a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="cf">if</span>(modulate_priors){</a>
<a class="sourceLine" id="cb5-9" title="9">    <span class="co"># Congruent</span></a>
<a class="sourceLine" id="cb5-10" title="10">    models<span class="op">$</span>bayesian &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/update">update</a></span>(models<span class="op">$</span>bayesian, <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dt">location =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb5-11" title="11">                                                              <span class="dt">scale =</span> params<span class="op">$</span>Prior_Scale,</a>
<a class="sourceLine" id="cb5-12" title="12">                                                              <span class="dt">autoscale =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-13" title="13">    params_congruent &lt;-<span class="st"> </span><span class="kw">compute_indices</span>(models)</a>
<a class="sourceLine" id="cb5-14" title="14">    params_congruent<span class="op">$</span>Prior &lt;-<span class="st"> "Congruent"</span></a>
<a class="sourceLine" id="cb5-15" title="15">    </a>
<a class="sourceLine" id="cb5-16" title="16">    <span class="co"># Incongruent</span></a>
<a class="sourceLine" id="cb5-17" title="17">    models<span class="op">$</span>bayesian &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/update">update</a></span>(models<span class="op">$</span>bayesian, <span class="dt">prior =</span> <span class="kw">normal</span>(<span class="dt">location =</span> <span class="dv">-1</span>, </a>
<a class="sourceLine" id="cb5-18" title="18">                                                              <span class="dt">scale =</span> params<span class="op">$</span>Prior_Scale,</a>
<a class="sourceLine" id="cb5-19" title="19">                                                              <span class="dt">autoscale =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb5-20" title="20">    params_incongruent &lt;-<span class="st"> </span><span class="kw">compute_indices</span>(models)</a>
<a class="sourceLine" id="cb5-21" title="21">    params_incongruent<span class="op">$</span>Prior &lt;-<span class="st"> "Incongruent"</span></a>
<a class="sourceLine" id="cb5-22" title="22">    </a>
<a class="sourceLine" id="cb5-23" title="23">    params &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(params, params_congruent, params_incongruent)</a>
<a class="sourceLine" id="cb5-24" title="24">  }</a>
<a class="sourceLine" id="cb5-25" title="25">  </a>
<a class="sourceLine" id="cb5-26" title="26">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(params) &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb5-27" title="27">  params</a>
<a class="sourceLine" id="cb5-28" title="28">}</a></code></pre></div>
</div>
</div>
<div id="study-1---sample-size-and-error" class="section level1">
<h1 class="hasAnchor">
<a href="#study-1---sample-size-and-error" class="anchor"></a>Study 1 - Sample Size and Error</h1>
<div id="method" class="section level2">
<h2 class="hasAnchor">
<a href="#method" class="anchor"></a>Method</h2>
<p>The simulation aimed at modulating the following characteristics:</p>
<ul>
<li>
<strong>Model type</strong>: linear or logistic.</li>
<li>
<strong>“True” effect</strong> (original regression coefficient from which data is drawn): Can be 1 or 0 (no effect).</li>
<li>
<strong>Sample size</strong>: From 20 to 100 by steps of 10.</li>
<li>
<strong>Error</strong>: Gaussian noise applied to the predictor with SD uniformly spread between 0.33 and 6.66 (with 1000 different values).</li>
</ul>
<p>We generated a dataset for each combination of these characteristics, resulting in a total of <code>2 * 2 * 9 * 1000 = 36000</code> Bayesian and frequentist models.</p>
</div>
<div id="generation" class="section level2">
<h2 class="hasAnchor">
<a href="#generation" class="anchor"></a>Generation</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">mc.cores =</span> parallel<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/parallel/topics/detectCores">detectCores</a></span>())</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">333</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co"># Parameters -------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb6-4" title="4">outcome_types &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"binary"</span>, <span class="st">"linear"</span>)</a>
<a class="sourceLine" id="cb6-5" title="5">effects &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb6-6" title="6">sample_sizes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">20</span>, <span class="dv">100</span>, <span class="dt">length.out =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb6-7" title="7">errors &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.33</span>, <span class="fl">6.66</span>, <span class="dt">length.out =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co"># Run --------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co"># Initialize data</span></a>
<a class="sourceLine" id="cb6-10" title="10">all_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co"># Start loop</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="cf">for</span>(outcome_type <span class="cf">in</span> outcome_types){</a>
<a class="sourceLine" id="cb6-13" title="13">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outcome_type)</a>
<a class="sourceLine" id="cb6-14" title="14">  <span class="cf">for</span>(true_effect <span class="cf">in</span> effects){</a>
<a class="sourceLine" id="cb6-15" title="15">    <span class="cf">for</span>(error <span class="cf">in</span> errors){</a>
<a class="sourceLine" id="cb6-16" title="16">      <span class="cf">for</span>(sample_size <span class="cf">in</span> sample_sizes){</a>
<a class="sourceLine" id="cb6-17" title="17">        <span class="cf">for</span>(iteration <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb6-18" title="18">          <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"."</span>)</a>
<a class="sourceLine" id="cb6-19" title="19">          </a>
<a class="sourceLine" id="cb6-20" title="20">          fail &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb6-21" title="21">          <span class="cf">while</span>(fail<span class="op">==</span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb6-22" title="22">            <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/conditions">tryCatch</a></span>({</a>
<a class="sourceLine" id="cb6-23" title="23">              params &lt;-<span class="st"> </span><span class="kw">generate_and_process</span>(<span class="dt">true_effect=</span>true_effect, <span class="dt">outcome_type=</span>outcome_type, <span class="dt">sample_size=</span>sample_size, <span class="dt">error=</span>error)</a>
<a class="sourceLine" id="cb6-24" title="24">              fail &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb6-25" title="25">            },<span class="dt">error=</span><span class="cf">function</span>(e){</a>
<a class="sourceLine" id="cb6-26" title="26">            },<span class="dt">warning=</span><span class="cf">function</span>(w){</a>
<a class="sourceLine" id="cb6-27" title="27">              <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"*"</span>)</a>
<a class="sourceLine" id="cb6-28" title="28">            })</a>
<a class="sourceLine" id="cb6-29" title="29">          }</a>
<a class="sourceLine" id="cb6-30" title="30">          <span class="co"># Save data</span></a>
<a class="sourceLine" id="cb6-31" title="31">          params &lt;-<span class="st"> </span><span class="kw">mutate</span>(params,</a>
<a class="sourceLine" id="cb6-32" title="32">                             <span class="dt">true_effect=</span>true_effect,</a>
<a class="sourceLine" id="cb6-33" title="33">                             <span class="dt">sample_size=</span>sample_size,</a>
<a class="sourceLine" id="cb6-34" title="34">                             <span class="dt">outcome_type =</span> outcome_type,</a>
<a class="sourceLine" id="cb6-35" title="35">                             <span class="dt">error =</span> error,</a>
<a class="sourceLine" id="cb6-36" title="36">                             <span class="dt">iteration=</span>iteration)</a>
<a class="sourceLine" id="cb6-37" title="37">          all_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(all_data, params)</a>
<a class="sourceLine" id="cb6-38" title="38">        }</a>
<a class="sourceLine" id="cb6-39" title="39">      }</a>
<a class="sourceLine" id="cb6-40" title="40">    }</a>
<a class="sourceLine" id="cb6-41" title="41">  }</a>
<a class="sourceLine" id="cb6-42" title="42">  <span class="co"># write.csv(all_data, "bayesSim_study1.csv", row.names = FALSE)</span></a>
<a class="sourceLine" id="cb6-43" title="43">}</a></code></pre></div>
</div>
<div id="visualise-data" class="section level2">
<h2 class="hasAnchor">
<a href="#visualise-data" class="anchor"></a>Visualise data</h2>
<div id="example-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">effects &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">sample_sizes &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">240</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">outcome_types &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"binary"</span>, <span class="st">"linear"</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">errors &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="fl">0.33</span>, <span class="fl">6.66</span>, <span class="dt">length.out =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6">example_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="cf">for</span>(outcome_type <span class="cf">in</span> outcome_types){</a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="cf">for</span>(true_effect <span class="cf">in</span> effects){</a>
<a class="sourceLine" id="cb7-9" title="9">    <span class="cf">for</span>(error <span class="cf">in</span> errors){</a>
<a class="sourceLine" id="cb7-10" title="10">      <span class="cf">for</span>(sample_size <span class="cf">in</span> sample_sizes){</a>
<a class="sourceLine" id="cb7-11" title="11">        data &lt;-<span class="st"> </span><span class="kw">generate_data</span>(true_effect, outcome_type, sample_size, error)</a>
<a class="sourceLine" id="cb7-12" title="12">        example_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(</a>
<a class="sourceLine" id="cb7-13" title="13">          example_data,</a>
<a class="sourceLine" id="cb7-14" title="14">          <span class="kw">mutate</span>(data,</a>
<a class="sourceLine" id="cb7-15" title="15">                 <span class="dt">true_effect=</span>true_effect,</a>
<a class="sourceLine" id="cb7-16" title="16">                 <span class="dt">outcome_type=</span>outcome_type,</a>
<a class="sourceLine" id="cb7-17" title="17">                 <span class="dt">sample_size=</span>sample_size,</a>
<a class="sourceLine" id="cb7-18" title="18">                 <span class="dt">error=</span>error))</a>
<a class="sourceLine" id="cb7-19" title="19">      }</a>
<a class="sourceLine" id="cb7-20" title="20">    }</a>
<a class="sourceLine" id="cb7-21" title="21">  }</a>
<a class="sourceLine" id="cb7-22" title="22">}</a>
<a class="sourceLine" id="cb7-23" title="23"></a>
<a class="sourceLine" id="cb7-24" title="24">linear_noeffect &lt;-<span class="st"> </span>example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-25" title="25"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(outcome_type <span class="op">==</span><span class="st"> "linear"</span>,</a>
<a class="sourceLine" id="cb7-26" title="26">         true_effect<span class="op">==</span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-27" title="27"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb7-28" title="28">         <span class="dt">error =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(error)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-29" title="29"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">color=</span>error)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-30" title="30"><span class="st">  </span><span class="kw">geom_point2</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-31" title="31"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">"lm"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-32" title="32"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-33" title="33"><span class="st">  </span><span class="kw">scale_color_material_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-34" title="34"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>error, <span class="dt">scale=</span><span class="st">"free"</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-35" title="35">linear_effect &lt;-<span class="st"> </span>example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-36" title="36"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(outcome_type <span class="op">==</span><span class="st"> "linear"</span>,</a>
<a class="sourceLine" id="cb7-37" title="37">         true_effect<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-38" title="38"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb7-39" title="39">         <span class="dt">error =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(error)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-40" title="40"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">color=</span>error)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-41" title="41"><span class="st">  </span><span class="kw">geom_point2</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-42" title="42"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">"lm"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-43" title="43"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-44" title="44"><span class="st">  </span><span class="kw">scale_color_material_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-45" title="45"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>error, <span class="dt">scale=</span><span class="st">"free"</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-46" title="46">binary_noeffect &lt;-<span class="st"> </span>example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-47" title="47"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(outcome_type <span class="op">==</span><span class="st"> "binary"</span>,</a>
<a class="sourceLine" id="cb7-48" title="48">         true_effect<span class="op">==</span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-49" title="49"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">true_effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(true_effect),</a>
<a class="sourceLine" id="cb7-50" title="50">         <span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb7-51" title="51">         <span class="dt">error =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(error)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-52" title="52"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">color=</span>error)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-53" title="53"><span class="st">  </span><span class="kw">geom_point2</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-54" title="54"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">"glm"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-55" title="55"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-56" title="56"><span class="st">  </span><span class="kw">scale_color_material_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-57" title="57"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>true_effect<span class="op">*</span>error, <span class="dt">scale=</span><span class="st">"free"</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-58" title="58">binary_effect &lt;-<span class="st"> </span>example_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-59" title="59"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(outcome_type <span class="op">==</span><span class="st"> "binary"</span>,</a>
<a class="sourceLine" id="cb7-60" title="60">         true_effect<span class="op">==</span><span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-61" title="61"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">true_effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(true_effect),</a>
<a class="sourceLine" id="cb7-62" title="62">         <span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb7-63" title="63">         <span class="dt">error =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(error)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-64" title="64"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">color=</span>error)) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-65" title="65"><span class="st">  </span><span class="kw">geom_point2</span>(<span class="dt">alpha=</span><span class="fl">0.2</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-66" title="66"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">"glm"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb7-67" title="67"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-68" title="68"><span class="st">  </span><span class="kw">scale_color_material_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-69" title="69"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>true_effect<span class="op">*</span>error, <span class="dt">scale=</span><span class="st">"free"</span>, <span class="dt">nrow=</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb7-70" title="70"></a>
<a class="sourceLine" id="cb7-71" title="71"><span class="kw">plots</span>(linear_effect, linear_noeffect, </a>
<a class="sourceLine" id="cb7-72" title="72">      binary_effect, binary_noeffect, </a>
<a class="sourceLine" id="cb7-73" title="73">      <span class="dt">nrow =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb7-74" title="74">      <span class="dt">tags=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Linear - Effect"</span>, <span class="st">"Linear - No effect"</span>,</a>
<a class="sourceLine" id="cb7-75" title="75">             <span class="st">"Binary - Effect"</span>, <span class="st">"Binary - No effect"</span>))</a></code></pre></div>
<p><img src="bayesian_indices_files/figure-html/unnamed-chunk-8-1.png" width="1536"></p>
</div>
<div id="observed-coefficients" class="section level3">
<h3 class="hasAnchor">
<a href="#observed-coefficients" class="anchor"></a>Observed Coefficients</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">all_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb8-3" title="3">         <span class="dt">beta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(beta),</a>
<a class="sourceLine" id="cb8-4" title="4">         <span class="dt">true_effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(true_effect)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>true_effect, <span class="dt">y=</span>beta, <span class="dt">fill=</span>sample_size)) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="st">  </span><span class="kw">scale_fill_material_d</span>(<span class="st">"rainbow"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Specified Coefficient"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Actual Coefficient</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>outcome_type, <span class="dt">scale=</span><span class="st">"free_y"</span>)</a></code></pre></div>
<p><img src="bayesian_indices_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">all_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb9-3" title="3">         <span class="dt">beta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(beta),</a>
<a class="sourceLine" id="cb9-4" title="4">         <span class="dt">error =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(error),</a>
<a class="sourceLine" id="cb9-5" title="5">         <span class="dt">true_effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(true_effect)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>error, <span class="dt">y=</span>beta, <span class="dt">color=</span>sample_size)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="st">  </span><span class="kw">geom_point2</span>(<span class="dt">alpha=</span><span class="fl">0.01</span>, <span class="dt">size=</span><span class="dv">3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se=</span><span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="st">  </span><span class="kw">scale_color_material_d</span>(<span class="st">"rainbow"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Error"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">"Actual Coefficient</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>outcome_type<span class="op">*</span>true_effect, <span class="dt">scale=</span><span class="st">"free"</span>)</a></code></pre></div>
<p><img src="bayesian_indices_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">all_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sample_size =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(sample_size),</a>
<a class="sourceLine" id="cb10-3" title="3">         <span class="dt">true_effect =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(true_effect),</a>
<a class="sourceLine" id="cb10-4" title="4">         <span class="dt">beta =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/numeric">as.numeric</a></span>(beta)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>beta, <span class="dt">fill=</span>sample_size)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha=</span><span class="fl">0.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="st">  </span><span class="kw">theme_modern</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-8" title="8"><span class="st">  </span><span class="kw">scale_fill_material_d</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="st">  </span><span class="kw">xlab</span>(<span class="st">"Actual Coefficient</span><span class="ch">\n</span><span class="st">"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>true_effect<span class="op">*</span>outcome_type, <span class="dt">scale=</span><span class="st">"free"</span>)</a></code></pre></div>
<p><img src="bayesian_indices_files/figure-html/unnamed-chunk-9-3.png" width="700"></p>
</div>
</div>
</div>
<div id="study-2---sampling-characteristics" class="section level1">
<h1 class="hasAnchor">
<a href="#study-2---sampling-characteristics" class="anchor"></a>Study 2 - Sampling Characteristics</h1>
<div id="method-1" class="section level2">
<h2 class="hasAnchor">
<a href="#method-1" class="anchor"></a>Method</h2>
<p>The simulation aimed at modulating the following characteristics:</p>
<ul>
<li>
<strong>Model type</strong>: linear or logistic.</li>
<li>
<strong>“True” effect</strong> (original regression coefficient from which data is drawn): Can be 1 or 0 (no effect).</li>
<li>
<strong>draws</strong>: from 10 to 5000 by step of 5 (1000 iterations).</li>
<li>
<strong>warmup</strong>: Ratio of warmup iterations. from 1/10 to 9/10 by step of 0.1 (9 iterations).</li>
</ul>
<p>We generated 3 datasets for each combination of these characteristics, resulting in a total of <code>2 * 2 * 1000 * 9 = 34560</code> Bayesian and frequentist models.</p>
</div>
<div id="generation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#generation-1" class="anchor"></a>Generation</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co"># options(mc.cores = parallel::detectCores())</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">333</span>)</a>
<a class="sourceLine" id="cb11-3" title="3"><span class="co"># Parameters -------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb11-4" title="4">outcome_types &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"binary"</span>, <span class="st">"linear"</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">effects &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-6" title="6"><span class="co"># chains &lt;- c(4)</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="co"># draws &lt;- seq(50, 5000, by=50)</span></a>
<a class="sourceLine" id="cb11-8" title="8"><span class="co"># warmups &lt;- seq(1/10, 9/10, by=1/10)</span></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="co"># Short version</span></a>
<a class="sourceLine" id="cb11-10" title="10">chains &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb11-11" title="11">draws &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="dt">by=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb11-12" title="12">warmups &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">3</span><span class="op">/</span><span class="dv">10</span>, <span class="dv">7</span><span class="op">/</span><span class="dv">10</span>, <span class="dt">by=</span><span class="dv">1</span><span class="op">/</span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb11-13" title="13"><span class="co"># Run --------------------------------------------------------------------------</span></a>
<a class="sourceLine" id="cb11-14" title="14"><span class="co"># Initialize data</span></a>
<a class="sourceLine" id="cb11-15" title="15">all_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>()</a>
<a class="sourceLine" id="cb11-16" title="16"><span class="co"># Start loop</span></a>
<a class="sourceLine" id="cb11-17" title="17"><span class="cf">for</span>(outcome_type <span class="cf">in</span> outcome_types){</a>
<a class="sourceLine" id="cb11-18" title="18">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(outcome_type)</a>
<a class="sourceLine" id="cb11-19" title="19">  <span class="cf">for</span>(true_effect <span class="cf">in</span> effects){</a>
<a class="sourceLine" id="cb11-20" title="20">    <span class="cf">for</span>(n_chains <span class="cf">in</span> chains){</a>
<a class="sourceLine" id="cb11-21" title="21">      <span class="cf">for</span>(n_draws <span class="cf">in</span> draws){</a>
<a class="sourceLine" id="cb11-22" title="22">        <span class="cf">for</span>(warmup <span class="cf">in</span> warmups){</a>
<a class="sourceLine" id="cb11-23" title="23">          <span class="cf">for</span>(iteration <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb11-24" title="24">            <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"."</span>)</a>
<a class="sourceLine" id="cb11-25" title="25">            </a>
<a class="sourceLine" id="cb11-26" title="26">            fail &lt;-<span class="st"> </span><span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb11-27" title="27">            <span class="cf">while</span>(fail<span class="op">==</span><span class="ot">TRUE</span>){</a>
<a class="sourceLine" id="cb11-28" title="28">              <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/conditions">tryCatch</a></span>({</a>
<a class="sourceLine" id="cb11-29" title="29">                params &lt;-<span class="st"> </span><span class="kw">generate_and_process</span>(<span class="dt">true_effect=</span>true_effect, <span class="dt">outcome_type=</span>outcome_type, <span class="dt">sample_size=</span><span class="dv">50</span>, <span class="dt">error=</span><span class="dv">1</span>, <span class="dt">type=</span><span class="st">"bayesian"</span>, <span class="dt">iter=</span>n_draws, <span class="dt">chains=</span>n_chains, <span class="dt">warmup=</span>warmup)</a>
<a class="sourceLine" id="cb11-30" title="30">                fail &lt;-<span class="st"> </span><span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb11-31" title="31">                params</a>
<a class="sourceLine" id="cb11-32" title="32">              },<span class="dt">error=</span><span class="cf">function</span>(e){</a>
<a class="sourceLine" id="cb11-33" title="33">              },<span class="dt">warning=</span><span class="cf">function</span>(w){</a>
<a class="sourceLine" id="cb11-34" title="34">                <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cat">cat</a></span>(<span class="st">"*"</span>)</a>
<a class="sourceLine" id="cb11-35" title="35">              })</a>
<a class="sourceLine" id="cb11-36" title="36">            }</a>
<a class="sourceLine" id="cb11-37" title="37">     </a>
<a class="sourceLine" id="cb11-38" title="38">            <span class="co"># Save data</span></a>
<a class="sourceLine" id="cb11-39" title="39">            params &lt;-<span class="st"> </span><span class="kw">mutate</span>(params,</a>
<a class="sourceLine" id="cb11-40" title="40">                              <span class="dt">true_effect=</span>true_effect,</a>
<a class="sourceLine" id="cb11-41" title="41">                              <span class="dt">outcome_type =</span> outcome_type,</a>
<a class="sourceLine" id="cb11-42" title="42">                              <span class="dt">iteration=</span>iteration)</a>
<a class="sourceLine" id="cb11-43" title="43">            all_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">rbind</a></span>(all_data, params)</a>
<a class="sourceLine" id="cb11-44" title="44">          }</a>
<a class="sourceLine" id="cb11-45" title="45">        }</a>
<a class="sourceLine" id="cb11-46" title="46">      }</a>
<a class="sourceLine" id="cb11-47" title="47">    }</a>
<a class="sourceLine" id="cb11-48" title="48">  }</a>
<a class="sourceLine" id="cb11-49" title="49">  <span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/write.table">write.csv</a></span>(all_data, <span class="st">"bayesSim_study2.csv"</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-50" title="50">}</a></code></pre></div>
</div>
</div>
<div id="study-3---priors-specification" class="section level1">
<h1 class="hasAnchor">
<a href="#study-3---priors-specification" class="anchor"></a>Study 3 - Priors Specification</h1>
<p>The simulation aimed at modulating the following characteristics:</p>
<ul>
<li>
<strong>Model type</strong>: linear or logistic.</li>
<li>
<strong>prior direction</strong>: either “congruent” (1), “uninformative” (0) or “opposite” (-1).</li>
<li>
<strong>prior precision</strong>: prior SD from 0.5 to 1.5.</li>
</ul>
</div>
<div id="session" class="section level1">
<h1 class="hasAnchor">
<a href="#session" class="anchor"></a>Session</h1>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/sessionInfo">sessionInfo</a></span>()</a></code></pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#functions">Functions</a><ul class="nav nav-pills nav-stacked">
<li><a href="#packages">Packages</a></li>
      <li><a href="#data-generation">Data generation</a></li>
      <li><a href="#model-fitting">Model fitting</a></li>
      <li><a href="#features-extraction">Features extraction</a></li>
      <li><a href="#wrapper">Wrapper</a></li>
      </ul>
</li>
      <li>
<a href="#study-1---sample-size-and-error">Study 1 - Sample Size and Error</a><ul class="nav nav-pills nav-stacked">
<li><a href="#method">Method</a></li>
      <li><a href="#generation">Generation</a></li>
      <li><a href="#visualise-data">Visualise data</a></li>
      </ul>
</li>
      <li>
<a href="#study-2---sampling-characteristics">Study 2 - Sampling Characteristics</a><ul class="nav nav-pills nav-stacked">
<li><a href="#method-1">Method</a></li>
      <li><a href="#generation-1">Generation</a></li>
      </ul>
</li>
      <li><a href="#study-3---priors-specification">Study 3 - Priors Specification</a></li>
      <li><a href="#session">Session</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a>, <a href="https://github.com/strengejacke">Daniel Lüdecke</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
